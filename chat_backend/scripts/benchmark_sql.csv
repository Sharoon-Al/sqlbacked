sno,question,question_category,query,,corrected question
1,How is residential billed water usage trending for 2023,not_order_by,"select u.usage_period as UsagePeriod, sum(u.billing_usage) as BillingUsage from uusehst u join uservice s on u.service_id = s.service_id join usvctyp t on s.service_type = t.service_type join ublh b on u.bill_id = b.bhstr# join ucls c on b.bhscls = c.uccls where status_type = 'BILLED' and bhscrc not in ('C', 'S') and ucdes like '%Residential%' and left(usage_period,4) = 2023 and t.utility_type = 'W' group by u.usage_period",,
2,Compare 2023 and 2022 residential water revenue,not_order_by,"SELECT SUBSTR(bhsrym, 1, 4) AS YEAR, SUM(bhstot) AS BILLINGREVENUE FROM uusehst u JOIN uservice s ON u.service_id = s.service_id JOIN usvctyp t ON s.service_type = t.service_type JOIN ublh b ON u.bill_id = b.bhstr# JOIN ucls c ON b.bhscls = c.uccls WHERE status_type = 'BILLED' AND bhscrc NOT IN ('C', 'S') AND ucdes LIKE '%Residential%' AND t.utility_type = 'W' AND SUBSTR(bhsrym, 1, 4) IN ('2022', '2023') GROUP BY SUBSTR(bhsrym, 1, 4) ORDER BY SUBSTR(bhsrym, 1, 4)",,
3,Show me the total number of active premises by District and Route.,not_order_by,"select UPRM.UPDST as District, UPRM.UPRTE as Route, URTE.UBDSC as RouteDescription, count(UPRM.UPPRM) as TotalPremises from UPRM inner join URTE on UPRM.UPRTE = URTE.UBRTE inner join UPST on UPRM.UPSTS = UPST.UIPSC where UPST.UIIAP <> 'Y' group by UPRM.UPDST, UPRM.UPRTE, URTE.UBDSC",,
4,Give me a list of water premises showing latitude and longitude.,not_order_by,"select distinct PREMISESID, SERVICETYP, SVCSIZETYP, PHYSCNCTDT, PHYSDSCNDT, BASEUSAGE, USAGEFCTR, LATITUDE, LONGITUDE, DESCRIPTN, CREATETS from USERVICE where SERVICETYP = 'W'",,
5,How many active multi-unit premises do we have?,not_order_by,SELECT COUNT(uprm.UPPRM) AS TotalMultiUnitPremises FROM UPRM INNER JOIN UPST ON uprm.UPSTS = upst.UIPSC WHERE upst.UIIAP <> 'Y' AND uprm.UPDUN > 1,,
6,How many bills were sent by bill cycle for month 202305?,not_order_by,"select BillCycle, sum(TotalBills) as TotalBills from ( SELECT bhsrcc as BillCycle, count(bhstr#) as TotalBills FROM ublh where bhsrym = 202305 and bhscod = 'C' group by bhsrcc union all SELECT ubcyc as BillCycle, count(bhstr#) as TotalBills FROM ublh a join urte b on a.bhsrcc = b.UBRTE where bhsrym = 202305 and bhscod = 'R' group by ubcyc) tbl group by BillCycle",,
7,List of accounts that had a cancelled bill during revenue month 202305.,not_order_by,"select bhstr# as BillId, bhsact as AccountId, bhsbld as BillDate from ublh where bhscrc = 'C' and bhsrym = 202305",,
8,What is the overall total usage by Unit of Measure for period 202305?,not_order_by,"select BILLING_UNIT_OF_MEASURE_TYPE as UnitofMeasure, sum(billing_usage) as BillingUsage from UUSEHST where usage_period = 202305 group by BILLING_UNIT_OF_MEASURE_TYPE",,
9,List of all services with adjusted usage for period 202304,not_order_by,"select SERVICE_ID as ServiceId, USAGE_PERIOD as UsagePeriod, BILLING_USAGE as BillingUsage from UUSEHST where USAGE_TYPE = 'ADJUSTMENT' and usage_period = 202304",,
11,List of disconnected services with unbilled usage without any time period filter.,not_order_by,"select PREMISES_ID as PremisesId, b.SERVICE_ID as ServiceId, SERVICE_TYPE as ServiceType, PHYSICAL_DISCONNECT_DATE as DisconnectDate, BILLING_USAGE as BillingUsage, STATUS_TYPE as Status from USERVICE a join UUSEHST b on a.SERVICE_ID = b.SERVICE_ID where PHYSICAL_DISCONNECT_DATE is not null and BILL_ID is null and STATUS_TYPE = 'READY'",,
12,List of accounts that are active at more than one premises.,not_order_by,"select ACCOUNT_AGREEMENT_ID as AccountId, count(distinct PREMISES_ID) as TotalPremises from UACTPRM where END_DATE is null group by ACCOUNT_AGREEMENT_ID having count(distinct PREMISES_ID) > 1",,
13,List of active premises with no active service.,not_order_by,"select a.UPPRM as PremisesId, UPCDT as PremisesEndDate, SERVICE_ID as ServiceId from UPRM a left outer join USERVICE b on a.UPPRM = b.PREMISES_ID inner join UPST c on a.UPSTS = c.UIPSC where c.UIIAP <> 'Y' AND a.UPPRM not in (select distinct bb.PREMISES_ID from uservice bb where PHYSICAL_DISCONNECT_DATE is null)",using uiiap for active premise filter,
14,List of active services with no active premises.,not_order_by,"select SERVICE_ID, PHYSICAL_DISCONNECT_DATE as ServiceEndDate, UPPRM as PremisesId, UPCDT as PremisesEndDate from USERVICE a left outer join UPRM b on a.PREMISES_ID = b.UPPRM where PHYSICAL_DISCONNECT_DATE is null and a.PREMISES_ID not in (select distinct bb.UPPRM from UPRM bb inner join UPST cc on bb.UPSTS = cc.UIPSC where cc.UIIAP = 'Y')",using uiiap for active premise filter,
15,List of premises having invalid Initial Start Date (not having valid date format) ?,not_order_by,"select upprm, left(cast(upidt as char(8)),4)||'-'|| substring(cast(upidt as char(8)),5,2)||'-'|| right(cast(upidt as char(8)),2) as InitialServiceDate, CASE WHEN TRY_CAST(left(cast(upidt as char(8)),4)||'-'|| substring(cast(upidt as char(8)),5,2)||'-'|| right(cast(upidt as char(8)),2) AS DATE) IS NOT NULL THEN 'Valid' ELSE 'Invalid' END AS DateValidity from uprm where CASE WHEN TRY_CAST(left(cast(upidt as char(8)),4)||'-'|| substring(cast(upidt as char(8)),5,2)||'-'|| right(cast(upidt as char(8)),2) AS DATE) IS NOT NULL THEN 'Valid' ELSE 'Invalid' END = 'Invalid'",,
16,List of premises with an invalid Discontinued Date,not_order_by,"select upprm, left(cast(upcdt as char(8)),4)||'-'|| substring(cast(upcdt as char(8)),5,2)||'-'|| right(cast(upcdt as char(8)),2) as DisconnectedDate, CASE WHEN TRY_CAST(left(cast(upcdt as char(8)),4)||'-'|| substring(cast(upcdt as char(8)),5,2)||'-'|| right(cast(upcdt as char(8)),2) AS DATE) IS NOT NULL THEN 'Valid' ELSE 'Invalid' END AS DateValidity from uprm where upcdt <> 0 and CASE WHEN TRY_CAST(left(cast(upcdt as char(8)),4)||'-'|| substring(cast(upcdt as char(8)),5,2)||'-'|| right(cast(upcdt as char(8)),2) AS DATE) IS NOT NULL THEN 'Valid' ELSE 'Invalid' END = 'Invalid'",,
19,Give me a list of premises where the route stop doesnt match the service stop.,not_order_by,"select a.SERVICE_ID as ServiceId, a.PREMISES_ID as PremisesId, a.METER_READING_STOP_NUMBER as ServiceRoute, UPSTP as PremisesRoute from uservice a join uprm b on a.PREMISES_ID = b.UPPRM where a.METER_READING_STOP_NUMBER <> b.UPSTP",,
20,Give me a list of services that are missing the serivce size.,not_order_by,"select SERVICE_ID as ServiceId, PREMISES_ID as PremisesId, SERVICE_SIZE_TYPE as ServiceSize from uservice where SERVICE_SIZE_TYPE is null",,
21,List of premises that are active with a discontinued date populated.,not_order_by,"select upprm as PremisesId, upcdt as DiscontinuedDate, upsts as PremisesStatus from uprm a join upst b on a.upsts = b.uipsc where uiiap = 'N' and upcdt <> 0 and upcdt is NOT NULL",Need to consider 0 and not null,
22,List of premises that have zero number of dwelling units.,not_order_by,"select upprm as PremisesId, updwc as DwellingCode, updun as DwellingUnits from uprm a where updun = 0",,
23,Which accounts' bills were not printed for revenue period 202306 for all accounts?,not_order_by,"select bhsact as AccountId, bhsprm as PremisesId, bhsbld as BillDate, bhsprt as PrintFlag from ublh where BHSPRT <> 'Y' and bhsrym = 202306",,
24,List of all EFT bills past their due date that have not drafted.,not_order_by,"select bhsact as AccountId, bhsprm as PremisesId, bhsbld as BillDate, bhspdd as DueDate, bhseft as EFTFlag from ublh where bhseft = '' and to_date(cast(bhspdd as char(8)),'YYYYMMDD') < current date",,
25,List of all accounts in cycle '10' that havent billed for revenue period '202306'?,not_order_by,"SELECT bhsact as AccountId, ubcyc as BillCycle, MAX(bhsbld) as LastBillDate FROM ublh a JOIN uactprm b ON a.bhsact = b.account_agreement_id AND a.bhsprm = b.premises JOIN uprm c ON b.premises_id = c.upprm JOIN urte d ON c.uprte = d.ubrte WHERE ubcyc = 10 AND bhscrc NOT IN ('C', 'S') AND end_date IS NULL GROUP BY bhsact, ubcyc HAVING LEFT(MAX(bhsbld),6) < 202306 AND MAX(bhsbld) IS NOT NULL;",considered end_date in the filter (as checked on 23),
28,How many units of Water Usage were billed with Usage Period Â '202306',not_order_by,"select t.utility_type as UtilityType, u.usage_period as UsagePeriod, sum(u.billing_usage) as BillingUsage from uusehst u join uservice s on u.service_id = s.service_id join usvctyp t on s.service_type = t.service_type join ublh b on u.bill_id = b.bhstr# where status_type = 'BILLED' and bhscrc not in ('C', 'S') and usage_period = 202306 and t.utility_type = 'W' group by t.utility_type, u.usage_period",,
30,How is residential water revenue trending for 2023,not_order_by,"select b.bhsrym as RevenuePeriod, sum(b.bhstot) as BillingRevenue from uusehst u join uservice s on u.service_id = s.service_id join usvctyp t on s.service_type = t.service_type join ublh b on u.bill_id = b.bhstr# join ucls c on b.bhscls = c.uccls where status_type = 'BILLED' and bhscrc not in ('C', 'S') and ucdes like '%Residential%' and left(usage_period,4) = 2023 and t.utility_type = 'W' group by b.bhsrym",revenue period or usage period for revenue trend?,
31,Give me the total number of active water services.,not_order_by,"SELECT a.SERVICE_TYPE AS ServiceType, b.DESCRIPTION AS ServiceTypeDescription, COUNT(DISTINCT a.SERVICE_ID) AS TotalServices FROM uservice a JOIN usvctyp b ON a.SERVICE_TYPE = b.SERVICE_TYPE WHERE b.DESCRIPTION LIKE '%Water%' AND a.PHYSICAL_DISCONNECT_DATE IS NULL GROUP BY a.SERVICE_TYPE, b.DESCRIPTION",,
10,List of services with unbilled usage older than 2 months.,not_order_by,"select SERVICE_ID as ServiceId, USAGE_PERIOD as UsagePeriod, BILLING_USAGE as BillingUsage, STATUS_TYPE as Status from UUSEHST where BILL_ID is null and STATUS_TYPE = 'READY' and to_date(cast(usage_period as char(6))||'01','YYYYMMDD') < DATE(SUBSTR(CHAR(now()), 1, 7) || '-01') - 2 months",,
17,Give me the total number of active electric services.,not_order_by,"SELECT a.SERVICE_TYPE AS ServiceType, b.DESCRIPTION AS ServiceTypeDescription, COUNT(DISTINCT a.SERVICE_ID) AS TotalServices FROM uservice a JOIN usvctyp b ON a.SERVICE_TYPE = b.SERVICE_TYPE WHERE b.DESCRIPTION LIKE '%Electric%' AND a.PHYSICAL_DISCONNECT_DATE IS NULL GROUP BY a.SERVICE_TYPE, b.DESCRIPTION",,
18,Give me a list of premises where the route stop doesnt match the service stop.,not_order_by,"select a.SERVICE_ID as ServiceId, a.PREMISES_ID as PremisesId, a.METER_READING_STOP_NUMBER as ServiceRoute, UPSTP as PremisesRoute from uservice a join uprm b on a.PREMISES_ID = b.UPPRM where a.METER_READING_STOP_NUMBER <> b.UPSTP",,
26,Last bill date of Account '881'/ Premises '10000514'?,not_order_by,"SELECT a.bhsact AS AccountId, a.bhsprm AS PremisesId, MAX(a.bhsbld) AS LastBillDate FROM ublh a JOIN uprm b ON a.bhsprm = b.upprm WHERE a.bhscrc NOT IN ('C', 'S') AND a.bhsact = 881 AND a.bhsprm like '%10000514%' GROUP BY a.bhsact, a.bhsprm",,
27,Compare 2023 and 2022 residential water billed usage,not_order_by,"SELECT SUBSTR(bhsrym, 1, 4) AS YEAR, SUM(billing_usage) AS BILLINGUSAGE FROM uusehst u JOIN uservice s ON u.service_id = s.service_id JOIN usvctyp t ON s.service_type = t.service_type JOIN ublh b ON u.bill_id = b.bhstr# JOIN ucls c ON b.bhscls = c.uccls WHERE status_type = 'BILLED' AND bhscrc NOT IN ('C', 'S') AND ucdes LIKE '%Residential%' AND t.utility_type = 'W'   AND SUBSTR(bhsrym, 1, 4) IN ('2022', '2023') GROUP BY SUBSTR(bhsrym, 1, 4) ORDER BY SUBSTR(bhsrym, 1, 4)",,
29,What was the billed revenue for water residential accounts for Revenue Period '202306',not_order_by,"select b.bhsrym as RevenuePeriod, sum(b.bhstot) as BillingRevenue from uusehst u join uservice s on u.service_id = s.service_id join usvctyp t on s.service_type = t.service_type join ublh b on u.bill_id = b.bhstr# join ucls c on b.bhscls = c.uccls where status_type = 'BILLED' and bhscrc not in ('C', 'S') and ucdes like '%Residential%' and bhsrym = 202306 and t.utility_type = 'W' group by b.bhsrym",,
32,What is total number of active premises with active services,not_order_by,SELECT COUNT(DISTINCT UPRM.UPPRM) AS TotalActivePremisesWithActiveServices FROM UPRM INNER JOIN USERVICE ON UPRM.UPPRM = USERVICE.PREMISES_ID INNER JOIN UPST ON UPRM.UPSTS = UPST.UIPSC WHERE UPST.UIIAP <> 'Y'   AND USERVICE.PHYSICAL_DISCONNECT_DATE IS NULL,,
33,Total count of discontinued date populated,not_order_by,select count(*) as TotalDiscontinued from UPRM where UPCDT <> 0,,
